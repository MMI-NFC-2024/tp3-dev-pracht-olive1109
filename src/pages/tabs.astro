---
import GraphicSpecies from "../components/GraphicSpecies.astro";
import { Tabs as AccessibleTabs, TabsList, TabsTab, TabsPanel } from 'accessible-astro-components';
import "../styles/global.css";
---

<main class="bg-gradient-to-r from-teal-100 to-teal-200 min-h-screen p-8">
    <header class="flex flex-col items-center justify-center mb-8 py-4 bg-white/70 rounded-xl shadow-md border border-teal-100">
      <nav class="flex gap-6 text-lg">
        <a href="/" class="font-semibold text-teal-500 hover:text-violet-900 underline decoration-teal-700 decoration-2">Home</a>
        <a href="/test-iframe" class="font-semibold text-teal-500 hover:text-violet-900 underline decoration-teal-700 decoration-2">IFRAME</a>
        <a href="/slider" class="font-semibold text-teal-500 hover:text-violet-900 underline decoration-teal-700 decoration-2">Slider</a>
      </nav>
      <h1 class="text-3xl text-center mt-4 text-teal-900 font-extrabold drop-shadow-lg">Comparaison graphique des especes (onglets accessibles)</h1>
    </header>
    <!-- Accessible Astro Tabs -->
    <AccessibleTabs>
      <TabsList class="flex gap-4 justify-center mb-6">
        <TabsTab id="tab1" controls="panel1" selected class="!bg-teal-500 !text-white !font-bold !rounded-lg !px-6 !py-2 !shadow-md !transition-all">Adelie</TabsTab>
        <TabsTab id="tab2" controls="panel2" class="!bg-teal-100 !text-teal-700 !font-bold !rounded-lg !px-6 !py-2 !shadow-md !transition-all">Gentoo</TabsTab>
        <TabsTab id="tab3" controls="panel3" class="!bg-teal-100 !text-teal-700 !font-bold !rounded-lg !px-6 !py-2 !shadow-md !transition-all">Chinstrap</TabsTab>
      </TabsList>
      <TabsPanel selected class="!p-4 !bg-white !rounded-lg">
        <div class="flex justify-center items-center">
          <div class="p-6 bg-white rounded-xl shadow-lg border border-blue-100 w-full max-w-xl">
            <GraphicSpecies species="Adelie" />
          </div>
        </div>
      </TabsPanel>
      <TabsPanel class="!p-4 !bg-white !rounded-lg">
        <div class="flex justify-center items-center">
          <div class="p-6 bg-white rounded-xl shadow-lg border border-blue-100 w-full max-w-xl">
            <GraphicSpecies species="Gentoo" />
          </div>
        </div>
      </TabsPanel>
      <TabsPanel class="!p-4 !bg-white !rounded-lg">
        <div class="flex justify-center items-center">
          <div class="p-6 bg-white rounded-xl shadow-lg border border-blue-100 w-full max-w-xl">
            <GraphicSpecies species="Chinstrap" />
          </div>
        </div>
      </TabsPanel>
    </AccessibleTabs>
</main>
<!-- Pour utiliser Accessible Astro Tabs, il faut installer le package et importer le composant Tabs si besoin -->

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const tabs = document.querySelectorAll('[role="tab"]');
    const panels = document.querySelectorAll('[role="tabpanel"]');

    tabs.forEach((tab, idx) => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.setAttribute('aria-selected', 'false'));
        panels.forEach((p, i) => {
          const panel = p as HTMLElement;
          panel.style.display = 'none';
          panel.classList.remove('bg-blue-900', 'text-white');
          panel.classList.add('bg-white', 'text-black');
        });
        tab.setAttribute('aria-selected', 'true');
        const activePanel = panels[idx] as HTMLElement;
        activePanel.style.display = 'block';
        activePanel.classList.remove('bg-white', 'text-black');
        activePanel.classList.add('bg-blue-900', 'text-white');
      });
    });

    // Initialisation : affiche le premier panel
    tabs[0].setAttribute('aria-selected', 'true');
    panels.forEach((p, i) => {
      const panel = p as HTMLElement;
      panel.style.display = i === 0 ? 'block' : 'none';
      if (i === 0) {
        panel.classList.remove('bg-white', 'text-black');
        panel.classList.add('bg-blue-900', 'text-white');
      } else {
        panel.classList.remove('bg-blue-900', 'text-white');
        panel.classList.add('bg-white', 'text-black');
      }
    });
  });
</script>